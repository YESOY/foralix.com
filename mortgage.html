<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <link rel="canonical" href="https://foralix.com/mortgage.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Mortgage Calculator: home loan simulation, fixed vs variable rates, total cost and borrowing capacity">

  <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5RH5T6NC');</script>
<!-- End Google Tag Manager -->

  
<!-- code adsense -->
   <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5655775153440301"
     crossorigin="anonymous"></script>
  
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WDSN8J1KJ6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-WDSN8J1KJ6');
</script>

  <script>
  // Track calculator usage
  function trackCalculatorUsage(calculatorName) {
    gtag('event', 'calculator_used', {
      'event_category': 'Calculators',
      'event_label': calculatorName
    });
  }

  // Track social shares
  function trackSocialShare(platform) {
    gtag('event', 'share', {
      'event_category': 'Social',
      'event_label': platform
    });
  }
</script>
  
  <script>
  // Force HTTPS redirect
  if (window.location.protocol === 'http:') {
    window.location.href = 'https://' + window.location.host + window.location.pathname + window.location.search + window.location.hash;
  }
  </script>

  <!-- In <head> section -->
<meta name="keywords" content="financial calculator, mortgage calculator, loan calculator, [page-specific keywords]">
<meta name="author" content="SmartCalcHub">
<link rel="canonical" href="https://foralix.com/mortgage.html">

<!-- Schema markup for each calculator -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication", 
  "name": "Mortgage Calculator",
  "applicationCategory": "FinanceApplication",
  "operatingSystem": "Any",
  "description": "Free mortgage calculator with taxes and insurance",
  "url": "https://www.foralix.com/mortgage.html"
}
</script>

  <meta name="keywords" content="mortgage calculator, monthly mortgage payment, home loan calculator, mortgage rates, PITI calculator, PMI calculator">
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Mortgage Calculator",
    "description": "Free online mortgage calculator with taxes, insurance, and PMI",
    "applicationCategory": "FinanceApplication",
    "operatingSystem": "Any"
  }
  </script>

  
  
  <title>Free Mortgage Calculator - Estimate Monthly Payments - SmartCalcHub</title>
  <meta name="description" content="Calculate your monthly mortgage payments with taxes, insurance, and PMI. Free online mortgage calculator for home buying.">
  <style>
    :root {
      --brand-primary: #007BFF;
      --brand-primary-dark: #0056b3;
      --brand-gradient: linear-gradient(135deg, #007BFF 0%, #0056b3 100%);
      --background: #f8fafc;
      --surface: #ffffff;
      --text-primary: #1e293b;
      --text-secondary: #475569;
      --text-muted: #64748b;
      --border: #e2e8f0;
      --border-light: #f1f5f9;
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --radius: 12px;
      --radius-lg: 20px;
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, Roboto, Arial, sans-serif;
      background: var(--background);
      color: var(--text-primary);
      line-height: 1.6;
      padding: 20px;
      max-width: 1000px;
      margin: 0 auto;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* Enhanced Header */
    .header {
      text-align: center;
      padding: 30px 20px;
      background: var(--surface);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow);
      margin-bottom: 30px;
      position: relative;
      overflow: hidden;
    }

    .header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--brand-gradient);
    }

    .header-content {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
      flex-wrap: wrap;
    }

    .brand-logo {
      width: 60px;
      height: 60px;
      border-radius: 16px;
      background: var(--brand-gradient);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 8px 20px rgba(0, 123, 255, 0.3);
      transition: var(--transition);
    }

    .brand-logo:hover {
      transform: scale(1.05) rotate(5deg);
    }

    .logo-icon {
      font-size: 28px;
      color: white;
      font-weight: bold;
    }

    .brand-text {
      text-align: left;
    }

    .header-title {
      margin: 0;
      font-size: 28px;
      font-weight: 700;
      background: var(--brand-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      line-height: 1.2;
    }

    .header-subtitle {
      color: var(--text-secondary);
      font-size: 14px;
      font-weight: 500;
      margin-top: 4px;
    }

    .header-link {
      text-decoration: none;
      color: inherit;
      transition: var(--transition);
    }

    .header-link:hover {
      opacity: 0.9;
    }

    /* Main Container */
    .container {
      background: var(--surface);
      padding: 30px;
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow);
      flex-grow: 1;
      border: 1px solid var(--border-light);
    }

    /* Calculator Header */
    .calculator-header {
      text-align: center;
      margin-bottom: 30px;
      position: relative;
    }

    .calculator-title {
      font-size: 24px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 8px;
    }

    .calculator-subtitle {
      color: var(--text-secondary);
      font-size: 14px;
    }

    .calculator-icon {
      width: 80px;
      height: 80px;
      border-radius: 20px;
      background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 20px;
      border: 2px solid #e0f2fe;
    }

    .calculator-icon i {
      font-size: 36px;
      background: var(--brand-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* Form Elements */
    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--text-secondary);
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .form-input {
      width: 100%;
      padding: 16px;
      border-radius: var(--radius);
      border: 2px solid var(--border);
      font-size: 16px;
      transition: var(--transition);
      background: #fafbfc;
      font-weight: 500;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--brand-primary);
      background: white;
      box-shadow: 0 0 0 4px rgba(0, 123, 255, 0.1);
      transform: translateY(-2px);
    }

    .form-input.error {
      border-color: #ef4444;
      background: #fef2f2;
    }

    .error-message {
      color: #ef4444;
      font-size: 14px;
      margin-top: 6px;
      display: none;
      font-weight: 500;
    }

    /* Buttons */
    .btn {
      width: 100%;
      padding: 16px;
      border-radius: var(--radius);
      border: none;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      position: relative;
      overflow: hidden;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s;
    }

    .btn:hover::before {
      left: 100%;
    }

    .btn-primary {
      background: var(--brand-gradient);
      color: white;
      box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 123, 255, 0.4);
    }

    .btn-secondary {
      background: #64748b;
      color: white;
    }

    .btn-secondary:hover {
      background: #475569;
    }

    /* Results */
    .result {
      margin-top: 24px;
      font-weight: bold;
      font-size: 18px;
      text-align: center;
      padding: 20px;
      border-radius: var(--radius);
      background-color: #f8fafc;
      display: none;
      border-left: 4px solid transparent;
    }

    .result.success {
      background-color: #f0fdf4;
      color: #166534;
      border-left-color: #22c55e;
    }

    .result.error {
      background-color: #fef2f2;
      color: #991b1b;
      border-left-color: #ef4444;
    }

    /* Additional Results */
    .additional-results {
      margin-top: 24px;
      display: none;
      background: #f8fafc;
      border-radius: var(--radius);
      padding: 20px;
      border: 1px solid var(--border-light);
    }

    .result-item {
      display: flex;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid var(--border-light);
    }

    .result-item:last-child {
      border-bottom: none;
    }

    .result-label {
      color: var(--text-secondary);
      font-weight: 500;
    }

    .result-value {
      font-weight: 700;
      color: var(--text-primary);
    }

    /* Payment Breakdown */
    .payment-breakdown {
      margin-top: 24px;
      display: none;
      background: #f8fafc;
      border-radius: var(--radius);
      padding: 20px;
      border: 1px solid var(--border-light);
    }

    .breakdown-item {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid var(--border-light);
    }

    .breakdown-item:last-child {
      border-bottom: none;
      font-weight: bold;
      border-top: 2px solid var(--border);
      margin-top: 10px;
      padding-top: 15px;
    }

    /* Share Section */
    .share {
      text-align: center;
      margin-top: 24px;
      padding: 16px;
      background: #f0f9ff;
      border-radius: var(--radius);
    }

    .share-link {
      text-decoration: none;
      color: var(--brand-primary);
      font-size: 14px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: var(--transition);
      font-weight: 600;
    }

    .share-link:hover {
      color: var(--brand-primary-dark);
      transform: translateY(-1px);
    }

    /* Footer */
    .footer {
      text-align: center;
      font-size: 12px;
      margin-top: 40px;
      color: var(--text-muted);
      padding: 20px 0;
    }

    /* Back Button */
    .back-button {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: var(--surface);
      color: var(--text-primary);
      padding: 14px 24px;
      text-decoration: none;
      border-radius: var(--radius);
      margin-top: 30px;
      transition: var(--transition);
      font-weight: 600;
      text-align: center;
      border: 2px solid var(--border);
      box-shadow: var(--shadow);
    }

    .back-button:hover {
      background: var(--brand-primary);
      color: white;
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
      border-color: var(--brand-primary);
    }

    .button-container {
      text-align: center;
      margin-top: 40px;
    }

    /* Responsive Adjustments */
    @media (max-width: 480px) {
      body {
        padding: 16px;
      }
      
      .container {
        padding: 24px 20px;
      }
      
      .calculator-title {
        font-size: 22px;
      }
      
      .header-content {
        flex-direction: column;
        text-align: center;
      }
      
      .brand-text {
        text-align: center;
      }
    }

    /* Animation for results */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .fade-in-up {
      animation: fadeInUp 0.5s ease-out;
    }
  </style>
</head>
<body>

   <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5RH5T6NC"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
  
  <header class="header" role="banner">
    <div class="header-content">
      <div class="brand-logo">
        <span class="logo-icon">‚àë</span>
      </div>
      <div class="brand-text">
        <a href="index.html" class="header-link">
          <h1 class="header-title">SmartCalcHub</h1>
          <div class="header-subtitle">Professional Financial Calculators</div>
        </a>
      </div>
    </div>
  </header>

  <section class="content-section" style="background: var(--surface); padding: 40px; border-radius: var(--radius-lg); margin-bottom: 30px; box-shadow: var(--shadow);">
    <div class="content-header" style="text-align: center; margin-bottom: 30px;">
        <h2 style="color: var(--text-primary); font-size: 2rem; margin-bottom: 15px;">Mortgage Payment Calculator</h2>
        <p style="color: var(--text-secondary); font-size: 1.1rem; max-width: 800px; margin: 0 auto;">Calculate your complete monthly mortgage payment including principal, interest, property taxes, home insurance, and PMI. Perfect for home buyers and refinancing.</p>
    </div>
    
    <div class="content-grid" style="display: grid; gap: 30px; grid-template-columns: 1fr;">
        <div class="content-block">
            <h3 style="color: var(--brand-primary); margin-bottom: 15px;">Understanding Mortgage Payments</h3>
            <p style="color: var(--text-secondary); line-height: 1.7; margin-bottom: 15px;">
                A mortgage payment consists of four main components: Principal (loan repayment), Interest (lender's fee), Taxes (property taxes), and Insurance (homeowners insurance). This is often called PITI. If your down payment is less than 20%, you'll also pay PMI (Private Mortgage Insurance).
            </p>
            <p style="color: var(--text-secondary); line-height: 1.7;">
                Understanding how these components work together helps you budget accurately and make informed decisions about your home purchase. Your monthly payment can vary significantly based on your down payment, loan term, and local tax rates.
            </p>
        </div>
        
        <div class="content-block">
            <h3 style="color: var(--brand-primary); margin-bottom: 15px;">How Our Mortgage Calculator Works</h3>
            <p style="color: var(--text-secondary); line-height: 1.7; margin-bottom: 15px;">
                Our calculator computes your complete monthly housing costs using the standard mortgage formula plus additional costs:
            </p>
            <div style="background: #f8f9fa; padding: 20px; border-radius: var(--radius); border-left: 4px solid var(--brand-primary); margin-bottom: 15px;">
                <p style="font-family: monospace; color: var(--text-primary); margin: 0;">
                    Total Payment = P&I + Property Tax + Insurance + PMI
                </p>
            </div>
            <p style="color: var(--text-secondary); line-height: 1.7;">
                Where:<br>
                ‚Ä¢ <strong>P&I</strong> = Principal & Interest (loan payment)<br>
                ‚Ä¢ <strong>Property Tax</strong> = Annual tax √∑ 12 months<br>
                ‚Ä¢ <strong>Insurance</strong> = Homeowners insurance √∑ 12 months<br>
                ‚Ä¢ <strong>PMI</strong> = Required if down payment < 20%<br>
            </p>
        </div>
    </div>
  </section>

  <main class="container" role="main">
    <div class="calculator-header">
      <div class="calculator-icon">
        <i>üè†</i>
      </div>
      <h1 class="calculator-title">Mortgage Payment Calculator</h1>
      <p class="calculator-subtitle">Calculate your complete monthly housing costs</p>
    </div>

    <!-- Mortgage Specific Form Fields -->
    <div class="form-group">
      <label for="home-price" class="form-label">Home Price</label>
      <input type="number" id="home-price" class="form-input" placeholder="Enter home price in USD" min="0" step="0.01" />
      <div id="home-price-error" class="error-message">Please enter a valid home price</div>
    </div>

    <div class="form-group">
      <label for="down-payment" class="form-label">Down Payment</label>
      <input type="number" id="down-payment" class="form-input" placeholder="Enter down payment amount" min="0" step="0.01" />
      <div id="down-payment-error" class="error-message">Please enter a valid down payment</div>
    </div>

    <div class="form-group">
      <label for="loan-term" class="form-label">Loan Term</label>
      <input type="number" id="loan-term" class="form-input" placeholder="Enter loan term in years" min="1" step="1" value="30" />
      <div id="loan-term-error" class="error-message">Please enter a valid loan term</div>
    </div>

    <div class="form-group">
      <label for="interest-rate" class="form-label">Interest Rate</label>
      <input type="number" id="interest-rate" class="form-input" placeholder="Enter annual interest rate (%)" min="0" step="0.01" value="4.5" />
      <div id="interest-rate-error" class="error-message">Please enter a valid interest rate</div>
    </div>

    <div class="form-group">
      <label for="property-tax" class="form-label">Annual Property Tax</label>
      <input type="number" id="property-tax" class="form-input" placeholder="Enter annual property tax" min="0" step="0.01" value="3000" />
      <div id="property-tax-error" class="error-message">Please enter a valid property tax amount</div>
    </div>

    <div class="form-group">
      <label for="home-insurance" class="form-label">Annual Home Insurance</label>
      <input type="number" id="home-insurance" class="form-input" placeholder="Enter annual insurance cost" min="0" step="0.01" value="1200" />
      <div id="home-insurance-error" class="error-message">Please enter a valid insurance amount</div>
    </div>

    <button id="calculate-btn" class="btn btn-primary">
      Calculate Mortgage Payment
    </button>

    <div id="result" class="result" role="status" aria-live="polite"></div>

    <div id="payment-breakdown" class="payment-breakdown">
      <h3 style="color: var(--text-primary); margin-bottom: 15px; text-align: center;">Monthly Payment Breakdown</h3>
      <div class="breakdown-item">
        <span class="result-label">Principal & Interest:</span>
        <span class="result-value" id="breakdown-pi">‚Äî</span>
      </div>
      <div class="breakdown-item">
        <span class="result-label">Property Tax:</span>
        <span class="result-value" id="breakdown-tax">‚Äî</span>
      </div>
      <div class="breakdown-item">
        <span class="result-label">Home Insurance:</span>
        <span class="result-value" id="breakdown-insurance">‚Äî</span>
      </div>
      <div class="breakdown-item">
        <span class="result-label">PMI:</span>
        <span class="result-value" id="breakdown-pmi">‚Äî</span>
      </div>
      <div class="breakdown-item">
        <span class="result-label">Total Monthly Payment:</span>
        <span class="result-value" id="breakdown-total">‚Äî</span>
      </div>
    </div>

    <div id="additional-results" class="additional-results">
      <div class="result-item">
        <span class="result-label">Loan Amount:</span>
        <span class="result-value" id="total-loan-amount">‚Äî</span>
      </div>
      <div class="result-item">
        <span class="result-label">Down Payment %:</span>
        <span class="result-value" id="down-payment-percent">‚Äî</span>
      </div>
      <div class="result-item">
        <span class="result-label">Total Payments (30 years):</span>
        <span class="result-value" id="total-payments">‚Äî</span>
      </div>
      <div class="result-item">
        <span class="result-label">Total Interest:</span>
        <span class="result-value" id="total-interest">‚Äî</span>
      </div>
    </div>

    <div id="amortization-schedule" class="additional-results" style="display: none;">
      <h3 style="color: var(--text-primary); margin-bottom: 15px; text-align: center;">Amortization Schedule (First 12 Months)</h3>
      <div style="max-height: 300px; overflow-y: auto;">
        <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
          <thead>
            <tr style="background: var(--background);">
              <th style="padding: 12px; text-align: left; border-bottom: 2px solid var(--border); font-weight: 600;">Month</th>
              <th style="padding: 12px; text-align: right; border-bottom: 2px solid var(--border); font-weight: 600;">Payment</th>
              <th style="padding: 12px; text-align: right; border-bottom: 2px solid var(--border); font-weight: 600;">Principal</th>
              <th style="padding: 12px; text-align: right; border-bottom: 2px solid var(--border); font-weight: 600;">Interest</th>
              <th style="padding: 12px; text-align: right; border-bottom: 2px solid var(--border); font-weight: 600;">Balance</th>
            </tr>
          </thead>
          <tbody id="amortization-body">
            <!-- JavaScript will populate this -->
          </tbody>
        </table>
      </div>
      <p style="text-align: center; color: var(--text-muted); font-size: 12px; margin-top: 10px;">
        Showing first 12 months. In early years, most payments go toward interest.
      </p>
    </div>

    <div class="share">
      <a href="#" id="share-link" class="share-link">
        <span>üì§</span> Share this tool on WhatsApp
      </a>
    </div>
  </main>

  <div class="button-container">
    <a href="index.html" class="back-button">
      ‚Üê Back to Homepage
    </a>
  </div>

  <footer class="footer" role="contentinfo">
    &copy; 2025 SmartCalcHub | All Rights Reserved
  </footer>

  <script>
    // DOM utility functions
    const $ = (id) => document.getElementById(id);
    const $$ = (selector) => document.querySelectorAll(selector);
    
    // Format currency
    const formatCurrency = (amount) => {
      return new Intl.NumberFormat('en-US', {
        style: 'currency',
        currency: 'USD',
        minimumFractionDigits: 2
      }).format(amount);
    };

    // Format percentage
    const formatPercent = (value) => {
      return value.toFixed(2) + '%';
    };

    // Calculate amortization schedule
    const calculateAmortization = (loanAmount, monthlyRate, monthlyPI, numberOfPayments) => {
      const schedule = [];
      let balance = loanAmount;
      
      for (let month = 1; month <= Math.min(12, numberOfPayments); month++) {
        const interestPayment = balance * monthlyRate;
        const principalPayment = monthlyPI - interestPayment;
        balance -= principalPayment;
        
        schedule.push({
          month: month,
          payment: monthlyPI,
          principal: principalPayment,
          interest: interestPayment,
          balance: Math.max(0, balance)
        });
      }
      
      return schedule;
    };

    // Display amortization schedule
    const displayAmortizationSchedule = (schedule) => {
      const amortizationBody = $('amortization-body');
      amortizationBody.innerHTML = '';
      
      schedule.forEach(item => {
        const row = document.createElement('tr');
        row.style.borderBottom = '1px solid var(--border-light)';
        row.innerHTML = `
          <td style="padding: 10px; text-align: left;">${item.month}</td>
          <td style="padding: 10px; text-align: right;">${formatCurrency(item.payment)}</td>
          <td style="padding: 10px; text-align: right; color: #059669;">${formatCurrency(item.principal)}</td>
          <td style="padding: 10px; text-align: right; color: #dc2626;">${formatCurrency(item.interest)}</td>
          <td style="padding: 10px; text-align: right;">${formatCurrency(item.balance)}</td>
        `;
        amortizationBody.appendChild(row);
      });
      
      $('amortization-schedule').className = 'additional-results fade-in-up';
      $('amortization-schedule').style.display = 'block';
    };

    // Calculate mortgage payment
    const calculateMortgage = () => {
      // Get input values
      const homePrice = parseFloat($('home-price').value);
      const downPayment = parseFloat($('down-payment').value);
      const loanTerm = parseFloat($('loan-term').value);
      const interestRate = parseFloat($('interest-rate').value) / 100;
      const propertyTax = parseFloat($('property-tax').value) || 0;
      const homeInsurance = parseFloat($('home-insurance').value) || 0;

      // Validate inputs
      if (!homePrice || homePrice <= 0) {
        showError('home-price-error', 'Please enter a valid home price');
        return null;
      }
      if (!downPayment || downPayment < 0 || downPayment >= homePrice) {
        showError('down-payment-error', 'Please enter a valid down payment');
        return null;
      }
      if (!loanTerm || loanTerm < 1) {
        showError('loan-term-error', 'Please enter a valid loan term');
        return null;
      }
      if (!interestRate || interestRate < 0) {
        showError('interest-rate-error', 'Please enter a valid interest rate');
        return null;
      }

      // Clear errors
      clearErrors();

      // Calculate loan amount
      const loanAmount = homePrice - downPayment;
      const downPaymentPercent = (downPayment / homePrice) * 100;

      // Calculate monthly principal & interest
      const monthlyRate = interestRate / 12;
      const numberOfPayments = loanTerm * 12;

      let monthlyPI;
      if (monthlyRate === 0) {
        monthlyPI = loanAmount / numberOfPayments;
      } else {
        monthlyPI = (loanAmount * monthlyRate) / (1 - Math.pow(1 + monthlyRate, -numberOfPayments));
      }

      // Calculate additional monthly costs
      const monthlyTax = propertyTax / 12;
      const monthlyInsurance = homeInsurance / 12;

      // Calculate PMI (0.75% annual if down payment < 20%)
      let monthlyPMI = 0;
      if (downPaymentPercent < 20) {
        const pmiRate = 0.0075; // 0.75% annual
        monthlyPMI = (loanAmount * pmiRate) / 12;
      }

      // Calculate total monthly payment
      const totalMonthlyPayment = monthlyPI + monthlyTax + monthlyInsurance + monthlyPMI;

      // Calculate totals over loan term
      const totalPayments = totalMonthlyPayment * numberOfPayments;
      const totalInterest = (monthlyPI * numberOfPayments) - loanAmount;

      return {
        loanAmount,
        downPaymentPercent,
        monthlyPI,
        monthlyTax,
        monthlyInsurance,
        monthlyPMI,
        totalMonthlyPayment,
        totalPayments,
        totalInterest,
        numberOfPayments,
        interestRate: interestRate
      };
    };

    // Show error message
    const showError = (errorId, message) => {
      $(errorId).textContent = message;
      $(errorId).style.display = 'block';
      $(errorId.split('-error')[0]).classList.add('error');
    };

    // Clear all errors
    const clearErrors = () => {
      $$('.error-message').forEach(el => el.style.display = 'none');
      $$('.form-input').forEach(el => el.classList.remove('error'));
    };

    // Display results
    const displayResults = (results) => {
      if (!results) {
        $('result').textContent = 'Please fix the errors above to calculate your payment.';
        $('result').className = 'result error';
        $('result').style.display = 'block';
        $('payment-breakdown').style.display = 'none';
        $('additional-results').style.display = 'none';
        $('amortization-schedule').style.display = 'none';
        return;
      }

      // Main result
      $('result').textContent = `Your estimated monthly payment is ${formatCurrency(results.totalMonthlyPayment)}`;
      $('result').className = 'result success fade-in-up';
      $('result').style.display = 'block';

      // Payment breakdown
      $('breakdown-pi').textContent = formatCurrency(results.monthlyPI);
      $('breakdown-tax').textContent = formatCurrency(results.monthlyTax);
      $('breakdown-insurance').textContent = formatCurrency(results.monthlyInsurance);
      $('breakdown-pmi').textContent = formatCurrency(results.monthlyPMI);
      $('breakdown-total').textContent = formatCurrency(results.totalMonthlyPayment);
      $('payment-breakdown').className = 'payment-breakdown fade-in-up';
      $('payment-breakdown').style.display = 'block';

      // Additional results
      $('total-loan-amount').textContent = formatCurrency(results.loanAmount);
      $('down-payment-percent').textContent = formatPercent(results.downPaymentPercent);
      $('total-payments').textContent = formatCurrency(results.totalPayments);
      $('total-interest').textContent = formatCurrency(results.totalInterest);
      $('additional-results').className = 'additional-results fade-in-up';
      $('additional-results').style.display = 'block';

      // Display amortization schedule
      const amortizationSchedule = calculateAmortization(
        results.loanAmount,
        results.interestRate / 12,
        results.monthlyPI,
        results.numberOfPayments
      );

      displayAmortizationSchedule(amortizationSchedule);
    };

    // Main calculation function
    const calculateMortgagePayment = () => {
      const results = calculateMortgage();
      displayResults(results);
      trackCalculatorUsage('Mortgage Calculator');
    };

    // Share on WhatsApp
    const shareOnWhatsApp = () => {
      const url = window.location.href;
      const text = "Check out this free Mortgage Calculator from SmartCalcHub: " + url;
      const whatsappUrl = "https://wa.me/?text=" + encodeURIComponent(text);
      window.open(whatsappUrl, "_blank");
    };

    // Initialize event listeners
    const initializeEventListeners = () => {
      $('calculate-btn').addEventListener('click', calculateMortgagePayment);
      $('share-link').addEventListener('click', shareOnWhatsApp);
      
      // Calculate on Enter key in any input
      $$('.form-input').forEach(input => {
        input.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
            calculateMortgagePayment();
          }
        });
        
        // Clear errors when user starts typing
        input.addEventListener('input', () => {
          input.classList.remove('error');
          const errorId = input.id + '-error';
          if ($(errorId)) {
            $(errorId).style.display = 'none';
          }
        });
      });
    };

    // Initialize the application
    const init = () => {
      initializeEventListeners();
      console.log('Mortgage Calculator initialized');
    };

    // Start when DOM is loaded
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
